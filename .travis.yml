language: ruby
rvm:
  - 2.5
env:
  global:
  - VAGRANT_VERSION="2.2.6"
services:
  - docker
before_install:
  - curl -o vagrant.zip vagrant.zip https://releases.hashicorp.com/vagrant/${VAGRANT_VERSION}/vagrant_${VAGRANT_VERSION}_linux_amd64.zip && unzip -d bin vagrant.zip
  - vagrant version
jobs:
  include:
    - stage: Vagrant validate
      before_script:
        - bundle install
      script:
        - PATH=$(pwd)/bin:$PATH bundle exec rake
        - PATH=$(pwd)/bin:$PATH bundle exec rake vagrant:validate
        - PATH=$(pwd)/bin:$PATH bundle exec rake --tasks
notifications:
  #email: false
   email:
     on_success: never # default: change
     on_failure: always # default: always
   webhooks: https://galaxy.ansible.com/api/v1/notifications/
